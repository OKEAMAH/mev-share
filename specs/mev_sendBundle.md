# `mev_sendBundle`

Send a bundle of transactions [and transaction hashes] to mev-share.

## JSON-RPC Scheme

```typescript
{
    jsonrpc: "2.0",
    id: string | number,
    method: "mev_sendBundle",
    params: [{ /* MevSendBundleParams */
        version: "0" | "beta-1",
        inclusion: {
            block: string,      // hex-encoded number
            maxBlock?: string,  // hex-encoded number
        },
        body: Array<
            { hash: string } |
            { tx: string, canRevert: boolean } |
            { bundle: MevSendBundleParams }
        >,
        validity: {
            refund: Array<{
                bodyIdx: number,
                percent: number,
            }>,
            refundConfig: Array<{
                address: string,
                percent: number,
            }>,
        },
        privacy?: {
            hints?: Array<
                "calldata" |
                "contract_address" |
                "logs" |
                "function_selector" |
                "hash"
            >,
            targetBuilders?: Array<string>,
        },
    }]
}
```

## `version`

Version of MEV-Share API specification to use.

## `inclusion`

Data used by block builders to check if bundle should be considered for inclusion in their block-building attempt. Data from `inclusion` is used as input for a predicate function that is fast to compute.

| Param | Type Info | Description |
|-|-|-|
| `block` | Hex-encoded string | The [first] block in which this bundle must be included. |
| `maxBlock` | Hex-encoded string; optional | The maximum block height in which this bundle _may_ be included. |

If only `block` is specified, the bundle may only be included in that block. If `maxBlock` is specified, the bundle may be included in any block between `block` and `maxBlock`, inclusively.

## `body`

An array of transactions to be sent; the body of the bundle. Each item in the array may include per-transaction validity conditions.

A transaction is wrapped in an object to specify which type of transaction it is.

Transactions picked up from listening to the mev-share endpoint will only give listeners a transaction hash (and not a signature). These transactions are placed in the array with the `{hash}` wrapper.

New signed transactions are placed in the array with the `{tx, canRevert}` wrapper.

An example (backrun) might look something like this:

```json
...
"body": [
    {
        "hash": "0x3232323232323232323232323232323232323232323232323232323232323232"
    },
    {
        "tx": "0x020424242424212312312312301230123012301230123012301230123012032424242123123124242421231231242424212312312424242123123124242421231231",
        "canRevert": false
    }
]
```

Entire bundles can also be included using the `{bundle}` wrapper. This example backruns a bundle with a transaction:

```json
{
  ...,
  "body": [
    {
      "bundle": {
        "version": "beta-1",
        "inclusion": {
          "block": "0x463e",
          "maxBlock": "0x4648"
        },
        "body": [
          {
            "tx": "0x02..."
          }
        ],
        "privacy": {
          "hints": [
            "calldata"
          ]
        },
        "validity": {
          "refundConfig": [
            {
              "address": "0x8EC1237b1E80A6adf191F40D4b7D095E21cdb18f",
              "percent": 100
            }
          ]
        }
      }
    },
    {
      "tx": "0x02..."
    }
  ],
  ...
}
```

### Bundle Composition

Bundles are designed to allow composition with other bundles. By specifying an empty object in the `body` array, searchers can specify if, and where, other transactions may be included with relation to their bundle.

For example, to allow another searcher to backrun their bundle, one could include an empty object at the end of the `body`:

```json
"body": [
    { "hash": "0x3232..." },
    { "tx": "0x0204...", "canRevert": false },
    {}
]
```

## `validity`

Requirements for the bundle to be included in a block, checked by the builder _after_ the bundle is considered for placement in a block.

For example, refund (MEV kickback) parameters are considered as a post-inclusion predicate, so they are specified here.

| Param | Type Info | Description |
|-|-|-|
| `refund` | Array of objects | Specifies the minimum percent to redistribute of a given bundle's earnings for it to be included in a builder's block. |
| `refund.bodyIdx` | Number | Index of entry in `body` to which the refund percentage applies. |
| `refund.percent` | Number | Minimum refund percentage required for this bundle to be eligible for use by another searcher, paid by said searcher from the profit generated by including this bundle in theirs. |
| `refundConfig` | Array of objects | Specifies what addresses should receive what percent of the overall refund for this bundle, if it is enveloped by another bundle (eg. a searcher backrun). The sum of percents in this array should equal 100. |
| `refundConfig.address` | String | Address which receives the portion of the refund specified herein. |
| `refundConfig.percent` | Number | Percentage of refund to pay to the address specified herein. |

## `privacy`

Preferences on what data should be shared about the bundle and its transactions. Optional.

| Param | Type Info | Description |
|-|-|-|
| `hints` | Array of strings; optional | Each item additively specifies which data about all transactions in the bundle to share. If no hints are specified, no data is shared. Transactions from other users that do not specify the same hints will not share additional information. |
| `targetBuilders` | Array of strings; optional | Builders that have permission to receive this bundle and include it in a block. |
